<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Assistant Tchoulo</title>
<style>
body{margin:0;font-family:Arial;background:#0d0d0d;color:white}
header{text-align:center;padding:15px;background:#111;font-size:22px;font-weight:bold;border-bottom:2px solid #1f1f1f}
#chat{height:70vh;overflow-y:auto;padding:20px}
.msg{max-width:80%;padding:12px;margin:10px 0;border-radius:10px}
.user{background:#0055ff;margin-left:auto;text-align:right}
.bot{background:#1e1e1e;border:1px solid #333;text-align:left}
#inputZone{display:flex;padding:15px;background:#111}
#text{flex:1;padding:12px;border-radius:8px;border:none;font-size:16px}
#send{margin-left:10px;padding:12px 16px;background:#00cc66;border:none;font-size:16px;border-radius:8px;cursor:pointer;color:black;font-weight:bold}
#clear{margin-left:10px;padding:12px 16px;background:#ff3333;border:none;font-size:14px;border-radius:8px;cursor:pointer;color:white}
.loading{font-style:italic;opacity:0.7;animation:blink 1s infinite}
@keyframes blink{50%{opacity:0.3}}
</style>
</head>
<body>

<header>Assistant Tchoulo ü§ñ</header>
<div id="chat"></div>
<div id="inputZone">
    <input type="text" id="text" placeholder="√âcrivez un message...">
    <button id="send">Envoyer</button>
    <button id="clear">Effacer</button>
</div>

<script>
const chat = document.getElementById("chat");
const text = document.getElementById("text");
const send = document.getElementById("send");
const clearBtn = document.getElementById("clear");

send.onclick = sendMessage;
text.addEventListener("keypress", e => { if(e.key==="Enter") sendMessage(); });
clearBtn.onclick = () => chat.innerHTML="";

function addMsg(content,sender){
    const div=document.createElement("div");
    div.className="msg "+sender;
    div.textContent=content;
    chat.appendChild(div);
    chat.scrollTop=chat.scrollHeight;
}

function loading(){
    const div=document.createElement("div");
    div.id="loading";
    div.className="msg bot loading";
    div.textContent="Tchoulo r√©fl√©chit...";
    chat.appendChild(div);
    chat.scrollTop=chat.scrollHeight;
}

async function sendMessage(){
    const message=text.value.trim();
    if(!message) return;
    addMsg(message,"user");
    text.value="";
    loading();

    try{
        const res=await fetch("http://localhost:3000/ask",{
            method:"POST",
            headers:{"Content-Type":"application/json"},
            body:JSON.stringify({message})
        });
        const data=await res.json();
        document.getElementById("loading").remove();
        addMsg(data.answer,"bot");
    }catch(err){
        document.getElementById("loading").remove();
        addMsg("‚ö†Ô∏è Tchoulo: Le serveur ne r√©pond pas.","bot");
    }
}
</script>

</body>
</html>